import{w as j}from"./with-props-b1i4h9El.js";import{r as n,l as t}from"./chunk-D52XG6IA-DVTnw_rV.js";import{C}from"./card-CTjxlscv.js";import{o as g,s as b,u as N,F as v,a as w,b as y,c as F,d as S,e as I,L as A,t as E}from"./loading-button-BQfSeoJ5.js";import{I as L}from"./input-CuhXqZKM.js";import{u as R}from"./use-toast-rhCGJxoN.js";import{g as p}from"./utils-CBmQbvEb.js";import"./index-B3XE2UaP.js";import"./label-BV3ipPG8.js";import"./index-DE-pzLVP.js";import"./index-DLfo2w2A.js";import"./index-CoB-VLMc.js";import"./index-BzlDct7J.js";import"./loader-circle-C0w-6Ez6.js";import"./createLucideIcon-BizpdrYR.js";const T=g({name:b().min(2)});function q(){const[d,m]=n.useState([]),[h,B]=n.useState(!1);n.useEffect(()=>{(async()=>{try{const u=(await(await p()).methods.getAllCandidates().call()).map(a=>({id:Number(a.id),name:a.name,voteCount:Number(a.voteCount)}));m(u)}catch(e){r({title:"Σφάλμα",description:e.message,variant:"destructive"})}})()},[h]);const o=N({resolver:E(T)}),[i,l]=n.useState(!1),{toast:r}=R(),f=async s=>{l(!0);try{const e=await p(),{name:c}=s,a=(await window.ethereum.request({method:"eth_requestAccounts"}))[0],x=await e.methods.getAllCandidates().call();m(x),await e.methods.addCandidate(c).send({from:a}),r({title:"Επιτυχία",description:`Ο υποψήφιος "${c}" προστέθηκε με επιτυχία!`,variant:"default"})}catch(e){r({title:"Σφάλμα",description:e.message,variant:"destructive"})}finally{l(!1)}};return t.jsxs("div",{className:"flex flex-col w-96",children:[t.jsx(C,{className:"p-4 h-min",children:t.jsx(v,{...o,children:t.jsxs("form",{className:"space-y-4",onSubmit:o.handleSubmit(f),children:[t.jsx("h1",{className:"text-2xl font-semibold",children:"Προσθήκη Υποψηφίου"}),t.jsx("div",{className:"grid gap-4",children:t.jsxs("div",{className:"grid gap-2",children:[t.jsx(w,{control:o.control,name:"name",render:({field:s})=>t.jsxs(y,{children:[t.jsx(F,{children:"Όνομα Υποψηφίου"}),t.jsx(S,{children:t.jsx(L,{...s,placeholder:"Όνομα Υποψηφίου",disabled:i})}),t.jsx(I,{})]})}),t.jsx(A,{loading:i,disabled:i,type:"submit",className:"w-full mt-2",children:"Προσθήκη Υποψηφίου"})]})})]})})}),t.jsxs("div",{className:"",children:[t.jsx("h1",{className:"text-2xl font-semibold",children:"Υποψήφιοι"}),t.jsx("ul",{className:"pt-2",children:d.map((s,e)=>t.jsx("li",{className:"list-disc",children:s.name},e))})]})]})}function W({}){return[{title:"Ψηφοφόροι"},{name:"description",content:"Ψηφοφόροι"}]}const X=j(function(){return t.jsx(q,{})});export{X as default,W as meta};
